!function(e){e.directive("a11yModal",["$window","$document","$compile",function(e,t,n){"use strict";function i(e,t){e instanceof angular.element&&e[0]&&(e=e[0]),e.classList&&e.setAttribute&&e.removeAttribute&&(t?e.removeAttribute("aria-hidden"):e.setAttribute("aria-hidden","hidden"))}function o(e,t){e instanceof angular.element&&e[0]&&(e=e[0]),e.classList&&e.setAttribute&&e.removeAttribute&&(i(e,t),t?(e.removeAttribute("hidden"),e.classList.remove("hidden")):(e.setAttribute("hidden","hidden"),e.classList.add("hidden")))}return{transclude:!0,restrict:"EA",scope:{shown:"=",modalHide:"&?",modalShow:"&?",modalClass:"&?",modalId:"&?"},compile:function(){var e=angular.element('<div hidden="hidden" class="a11yModal-hider"></div>');return{post:function(r,a,c,d,u){function s(t){t.target===e[0]&&(t.preventDefault(),t.stopPropagation(),r.modalHide&&r.modalHide(),e[0].removeEventListener("click",s),r.$apply())}a.remove();var l=angular.element('<div class="a11yModal-content" tab-index="-1" a11y-esc="modalHide()" a11y-capture-tab></div>');r.modalId&&l.attr("id",r.modalId),r.modalClass&&l.attr("class","a11yModal-content "+r.modalClass()),r.$on("$destroy",function(){e[0].removeEventListener("click",s)});var f;r.hide=function(){f&&f.$destroy(),l.empty(),e.empty(),e.detach(),angular.forEach(t.find("body").children(),function(e){i(e,!0)}),o(e,!1)},r.show=function(){f=r.$new(),angular.forEach(t.find("body").children(),function(e){i(e,!1)}),t.find("body").append(e),e.append(l),u(function(e){l.append(e)}),o(e,!0),n(l)(f),r.modalShow&&r.modalShow(),e[0].addEventListener("click",s)},r.$watch("shown",function(e){e?r.show():r.hide()})}}}}}]),e.directive("a11yEsc",["$window",function(e){return{restrict:"CA",scope:{a11yEsc:"&"},controller:["$scope",function(t){function n(i){27===i.keyCode&&t.$apply(function(){t.a11yEsc({$event:i}),e.removeEventListener("keyup",n,!0)})}e.addEventListener("keyup",n,!0),t.$on("$destroy",function(){e.removeEventListener("keyup",n,!0)})}]}}]),e.directive("a11yCaptureTab",function(){return{link:function(e,t,n){function i(e){9!==e.which||t[0].contains(e.target)||(e.preventDefault(),o(),c.focus())}function o(){a=t[0].querySelectorAll("select, input, textarea, button, a"),a.filter&&(a=a.filter(":visible")),c=a[0],d=a[a.length-1]}function r(e){o(),d!==e.target||9!==e.which||e.shiftKey||(e.preventDefault(),c.focus()),c===e.target&&9===e.which&&e.shiftKey&&(e.preventDefault(),d.focus())}var a,c,d,u;u=document.activeElement,o(),e.$eval(n.forceCapture)&&(document.body.addEventListener("keydown",i,!0),e.$on("$destroy",function(){document.body.removeEventListener("keydown",i),u.focus()})),e.$eval(n.captureImmediate)&&c.focus(),t[0].addEventListener("keydown",function(e){r(e)},!0)}}}),e.directive("withService",["$injector",function(e){return{restrict:"A",scope:!0,link:function(t,n,i){var o="undefined"!=typeof _?_.forEach:function(e,t){Object.keys(e).forEach(function(n){t(e[n],n)})};if(i.withService){if("{"===i.withService.trim()[0]){var r=t.$eval(i.withService);return void o(r,function(n,i){t[i]=e.get(n)})}if("["===i.withService.trim()[0])return void o(t.$eval(i.withService),function(n){t[n]=e.get(n)});var a=i.withService.split(" as "),c=e.get(a[0]);c&&(t[a[1]||a[0]]=c)}}}}])}(angular.module("ng-a11y",[]));