!function(e){e.directive("a11yModal",["$window","$document","$compile",function(e,t,n){"use strict";function i(e,t){e instanceof angular.element&&e[0]&&(e=e[0]),e.classList&&e.setAttribute&&e.removeAttribute&&(t?e.removeAttribute("aria-hidden"):e.setAttribute("aria-hidden","hidden"))}function o(e,t){e instanceof angular.element&&e[0]&&(e=e[0]),e.classList&&e.setAttribute&&e.removeAttribute&&(i(e,t),t?(e.removeAttribute("hidden"),e.classList.remove("hidden")):(e.setAttribute("hidden","hidden"),e.classList.add("hidden")))}return{transclude:!0,restrict:"EA",scope:{shown:"=",modalHide:"&?",modalShow:"&?",modalClass:"&?",modalId:"&?"},compile:function(){var e=angular.element('<div hidden="hidden" class="a11yModal-hider"></div>');return{post:function(d,a,c,r,u){a.remove();var s=angular.element('<div class="a11yModal-content" tab-index="-1" on-esc="modalHide()" up-capture-tab></div>');d.modalId&&s.attr("id",d.modalId),d.modalClass&&s.attr("class","a11yModal-content "+d.modalClass()),e.on("click",function(t){t.target===e&&d.modalHide&&d.modalHide()});var l;d.hide=function(){l&&l.$destroy(),s.empty(),e.empty(),e.detach(),t.find("body").children().each(function(e,t){i(t,!0)}),o(e,!1)},d.show=function(){l=d.$new(),t.find("body").children().each(function(e,t){i(t,!1)}),t.find("body").append(e),e.append(s),u(function(e){s.append(e)}),o(e,!0),n(s)(l),d.modalShow&&d.modalShow()},d.$watch("shown",function(e){e?d.show():d.hide()})}}}}}]),e.directive("a11yEsc",["$window",function(e){return{restrict:"CA",scope:{onEsc:"&"},controller:["$scope",function(t){function n(i){27===i.keyCode&&t.$apply(function(){t.onEsc({$event:i}),e.removeEventListener("keyup",n)})}e.addEventListener("keyup",n,!0)}]}}]),e.directive("a11yCaptureTab",function(){return{link:function(e,t){function n(e){9!==e.which||t[0].contains(e.target)||(i(),a.focus())}function i(){d=t.find("select, input, textarea, button, a"),d.filter&&(d=d.filter(":visible")),a=d.first(),c=d.last()}function o(e){i(),c[0]!==e.target||9!==e.which||e.shiftKey||(e.preventDefault(),a.focus()),a[0]===e.target&&9===e.which&&e.shiftKey&&(e.preventDefault(),c.focus())}var d,a,c,r;r=angular.element(document.activeElement),i(),document.body.addEventListener("keydown",n,!0),e.$on("$destroy",function(){document.body.removeEventListener("keydown",n),r.focus()}),a.focus(),t[0].addEventListener("keydown",function(e){o(e)},!0)}}}),e.directive("withService",["$injector",function(e){return{restrict:"A",scope:!0,link:function(t,n,i){var o="undefined"!=typeof _?_.forEach:function(e,t){Object.keys(e).forEach(function(n){t(e[n],n)})};if(i.withService){if("{"===i.withService.trim()[0]){var d=t.$eval(i.withService);return void o(d,function(n,i){t[i]=e.get(n)})}if("["===i.withService.trim()[0])return void o(t.$eval(i.withService),function(n){t[n]=e.get(n)});var a=i.withService.split(" as "),c=e.get(a[0]);c&&(t[a[1]||a[0]]=c)}}}}])}(angular.module("ng-a11y",[]));